{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{gapi}from'gapi-script';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CLIENT_ID='591704407107-lh3mjl4c9t9co83akvrco6v7vlguq37s.apps.googleusercontent.com';const API_KEY='AIzaSyDmvixL1GMLpRgba_hs1FMSSArB56LMjxc';const SCOPES='https://www.googleapis.com/auth/calendar.events';function Calendar(){const{id}=useParams();// ID del torneo\nconst[events,setEvents]=useState([]);const[error,setError]=useState('');const[isAuthenticated,setIsAuthenticated]=useState(false);useEffect(()=>{if(!window.gapi){setError('Google API no est√° disponible');return;}window.gapi.load('client:auth2',()=>{window.gapi.client.init({apiKey:API_KEY,clientId:CLIENT_ID,scope:SCOPES,discoveryDocs:['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest']}).then(()=>{const authInstance=window.gapi.auth2.getAuthInstance();if(!authInstance.isSignedIn.get()){authInstance.signIn().then(()=>{handleAuth();}).catch(err=>{setError('Error al iniciar sesi√≥n con Google');console.error(err);});}else{handleAuth();}}).catch(err=>{setError('Error al inicializar gapi');console.error(err);});});},[]);const handleAuth=()=>{try{const googleUser=window.gapi.auth2.getAuthInstance().currentUser.get();const accessToken=googleUser.getAuthResponse().access_token;fetch('http://localhost:3000/set-auth',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token:accessToken})}).then(res=>{if(!res.ok)throw new Error('Error en set-auth');setIsAuthenticated(true);loadEvents();}).catch(err=>{setError('Error al conectar con el microservicio');console.error(err);});}catch(err){setError('Error al obtener token de Google');console.error(err);}};const loadEvents=()=>{fetch('http://localhost:3000/events').then(res=>res.json()).then(data=>setEvents(data)).catch(err=>{setError('Error al cargar eventos');console.error(err);});};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'2rem'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Calendar del torneo\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),!isAuthenticated?/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83D\\uDD10 Iniciando sesi\\xF3n con Google...\"}):/*#__PURE__*/_jsx(\"ul\",{children:events.map(ev=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:ev.summary}),/*#__PURE__*/_jsx(\"br\",{}),ev.start.dateTime||ev.start.date,\" \\u2192 \",ev.end.dateTime||ev.end.date]},ev.id))})]});}export default Calendar;","map":{"version":3,"names":["React","useEffect","useState","useParams","gapi","jsx","_jsx","jsxs","_jsxs","CLIENT_ID","API_KEY","SCOPES","Calendar","id","events","setEvents","error","setError","isAuthenticated","setIsAuthenticated","window","load","client","init","apiKey","clientId","scope","discoveryDocs","then","authInstance","auth2","getAuthInstance","isSignedIn","get","signIn","handleAuth","catch","err","console","googleUser","currentUser","accessToken","getAuthResponse","access_token","fetch","method","headers","body","JSON","stringify","token","res","ok","Error","loadEvents","json","data","style","padding","children","color","map","ev","summary","start","dateTime","date","end"],"sources":["C:/Users/kevin/Downloads/DEVNUBE/sports-platform/Frontend/admin-panel/src/pages/Calendar.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { gapi } from 'gapi-script';\r\n\r\nconst CLIENT_ID = '591704407107-lh3mjl4c9t9co83akvrco6v7vlguq37s.apps.googleusercontent.com';\r\nconst API_KEY = 'AIzaSyDmvixL1GMLpRgba_hs1FMSSArB56LMjxc';\r\nconst SCOPES = 'https://www.googleapis.com/auth/calendar.events';\r\n\r\nfunction Calendar() {\r\n  const { id } = useParams(); // ID del torneo\r\n  const [events, setEvents] = useState([]);\r\n  const [error, setError] = useState('');\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!window.gapi) {\r\n      setError('Google API no est√° disponible');\r\n      return;\r\n    }\r\n\r\n    window.gapi.load('client:auth2', () => {\r\n      window.gapi.client.init({\r\n        apiKey: API_KEY,\r\n        clientId: CLIENT_ID,\r\n        scope: SCOPES,\r\n        discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest']\r\n      }).then(() => {\r\n        const authInstance = window.gapi.auth2.getAuthInstance();\r\n        if (!authInstance.isSignedIn.get()) {\r\n          authInstance.signIn().then(() => {\r\n            handleAuth();\r\n          }).catch(err => {\r\n            setError('Error al iniciar sesi√≥n con Google');\r\n            console.error(err);\r\n          });\r\n        } else {\r\n          handleAuth();\r\n        }\r\n      }).catch(err => {\r\n        setError('Error al inicializar gapi');\r\n        console.error(err);\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  const handleAuth = () => {\r\n    try {\r\n      const googleUser = window.gapi.auth2.getAuthInstance().currentUser.get();\r\n      const accessToken = googleUser.getAuthResponse().access_token;\r\n\r\n      fetch('http://localhost:3000/set-auth', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ token: accessToken })\r\n      })\r\n      .then(res => {\r\n        if (!res.ok) throw new Error('Error en set-auth');\r\n        setIsAuthenticated(true);\r\n        loadEvents();\r\n      })\r\n      .catch(err => {\r\n        setError('Error al conectar con el microservicio');\r\n        console.error(err);\r\n      });\r\n    } catch (err) {\r\n      setError('Error al obtener token de Google');\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const loadEvents = () => {\r\n    fetch('http://localhost:3000/events')\r\n      .then(res => res.json())\r\n      .then(data => setEvents(data))\r\n      .catch(err => {\r\n        setError('Error al cargar eventos');\r\n        console.error(err);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '2rem' }}>\r\n      <h2>Calendar del torneo</h2>\r\n      {error && <p style={{ color: 'red' }}>{error}</p>}\r\n      {!isAuthenticated ? (\r\n        <p>üîê Iniciando sesi√≥n con Google...</p>\r\n      ) : (\r\n        <ul>\r\n          {events.map(ev => (\r\n            <li key={ev.id}>\r\n              <strong>{ev.summary}</strong><br />\r\n              {ev.start.dateTime || ev.start.date} ‚Üí {ev.end.dateTime || ev.end.date}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Calendar;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}